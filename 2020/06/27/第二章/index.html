<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>第二章：推荐系统的进化之路 | daluzi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一、整体框架   传统推荐系统的发展脉络主要由以下四个部分组成：  协同过滤算法族：物品协同过滤（ItemCF）、用户协同过滤（UserCF）、矩阵分解模型（Matrix Factorization）及各分支模型； 逻辑回归模型族：逻辑回归能够利用和融合更多用户、物品和上下文特征。LR模型、LS-PLM模型等； 因子分解机模型族：在传统逻辑回归的基础上，加入了二阶部分，使模型具备了进行特征组合的能">
<meta name="keywords" content="recommendation,DL">
<meta property="og:type" content="article">
<meta property="og:title" content="第二章：推荐系统的进化之路">
<meta property="og:url" content="http:&#x2F;&#x2F;daluzi.top&#x2F;2020&#x2F;06&#x2F;27&#x2F;%E7%AC%AC%E4%BA%8C%E7%AB%A0&#x2F;index.html">
<meta property="og:site_name" content="daluzi">
<meta property="og:description" content="一、整体框架   传统推荐系统的发展脉络主要由以下四个部分组成：  协同过滤算法族：物品协同过滤（ItemCF）、用户协同过滤（UserCF）、矩阵分解模型（Matrix Factorization）及各分支模型； 逻辑回归模型族：逻辑回归能够利用和融合更多用户、物品和上下文特征。LR模型、LS-PLM模型等； 因子分解机模型族：在传统逻辑回归的基础上，加入了二阶部分，使模型具备了进行特征组合的能">
<meta property="og:locale" content="en">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;07&#x2F;11&#x2F;vndB6QLsTbFJNGg.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;07&#x2F;11&#x2F;Xjb4Q8YEUoDknJ3.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;07&#x2F;11&#x2F;bFJ4WoyBGTvUDpg.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;07&#x2F;11&#x2F;Uzw2Id8ER1t3Prx.jpg">
<meta property="og:updated_time" content="2020-07-11T07:49:56.912Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;07&#x2F;11&#x2F;vndB6QLsTbFJNGg.jpg">
  
    <link rel="alternate" href="../../../../atom.xml" title="daluzi" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="../../../../css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">daluzi</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="../../../../atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://daluzi.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-第二章" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2020-06-27T11:48:46.000Z" itemprop="datePublished">2020-06-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/%E3%80%8A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E3%80%8B/">《深度学习推荐系统》</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      第二章：推荐系统的进化之路
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2>一、整体框架</h2>

<p><img src="https://i.loli.net/2020/07/11/vndB6QLsTbFJNGg.jpg" alt="1.png"></p>
<p>传统推荐系统的发展脉络主要由以下四个部分组成：</p>
<ul>
<li><b>协同过滤算法族：</b>物品协同过滤（ItemCF）、用户协同过滤（UserCF）、矩阵分解模型（Matrix Factorization）及各分支模型；</li>
<li><b>逻辑回归模型族：</b>逻辑回归能够利用和融合更多用户、物品和上下文特征。LR模型、LS-PLM模型等；</li>
<li><b>因子分解机模型族：</b>在传统逻辑回归的基础上，加入了二阶部分，使模型具备了进行<font color='red'>特征组合</font>的能力。FM模型、FFM模型；</li>
<li><b>组合模型：</b>为了融合多个模型的优点，将不同模型组合使用是构建推荐模型常用的方法。GBDT+LR等。</li>
</ul>
<h2>二、协同过滤</h2>

<p><em>协同过滤的提出：2003年Amazon发表文章<a href="https://ieeexplore.ieee.org/document/1167344" target="_blank" rel="noopener">Amazon.com recommendations: item-to-item collaborative filtering</a></em></p>
<h4 id="2-1-定义"><a href="#2-1-定义" class="headerlink" title="2.1 定义"></a>2.1 定义</h4><p>协同大家的反馈、评价和意见一起对海量的信息进行过滤，从中筛选出目标用户可能感兴趣的信息的推荐过程。</p>
<p><img src="https://i.loli.net/2020/07/11/Xjb4Q8YEUoDknJ3.jpg" alt="366139DF-46C7-47B9-A03F-7237B62B0EEA.png"></p>
<p><b>共现矩阵：</b>以上图为例，将有向图转成矩阵的形式，用户作为矩阵行坐标，商品作为列坐标，将“点赞”和“踩”的用户行为数据转换为矩阵中对应的元素值。</p>
<h4 id="2-2-用户相似度计算"><a href="#2-2-用户相似度计算" class="headerlink" title="2.2 用户相似度计算"></a>2.2 用户相似度计算</h4><p>对于用户向量<code>i</code>和用户向量<code>j</code></p>
<ol>
<li>余弦相似度：$sim(i,j)=cos(i,j)=\frac{i·j}{||i||·||j||}$</li>
<li>皮尔逊相关系数：<br>$$sim(i,j)=\frac{\Sigma_{p\in P}(R_{i,P} - \hat{R}<em>i)(R</em>{j,P}-\hat{R}<em>j)}{\sqrt[]{\Sigma</em>{p\in P}(R_{i,P}- \hat{R}<em>i)^2}\sqrt[]{\Sigma</em>{p\in P}(R_{j,P}- \hat{R}<em>j)^2}}$$<br>其中，`R</em>{i,p}<code>代表用户</code>i<code>对物品</code>p<code>的评分，$\hat{R}_i$是代表用户</code>i<code>对所有物品的平均评分，</code>p`代表所有物品的集合。</li>
<li>基于皮尔逊系数的思路，还可以通过引入物品平均分的方式，<b>减少物品评分偏置对结果的影响:</b><br>$$sim(i,j)=\frac{\Sigma_{p\in P}(R_{i,P} - \hat{R}<em>P)(R</em>{j,P}-\hat{R}<em>P)}{\sqrt[]{\Sigma</em>{p\in P}(R_{i,P}- \hat{R}<em>P)^2}\sqrt[]{\Sigma</em>{p\in P}(R_{j,P}- \hat{R}_P)^2}}$$<br>其中，$\hat{R}_p$代表物品<code>p</code>得到所有评分的平均分。</li>
</ol>
<h4>2.3 最终结果的排序</h4>

<p>假设“目标用户与其相似用户的喜好是相似的”</p>
<p>最常用的方式是<b>利用用户相似度和相似用户的评价的加权平均获得目标用户的评分预测</b>，如下：</p>
<p>$$R_{u,p}=\frac{\Sigma_{s\in S}(W_{u,s}·R_{s,p})}{\Sigma_{s\in S}W_{u,s}}$$</p>
<p>其中，权重$W_{u,s}$是用户<code>u</code>和用户<code>s</code>的相似度，$R_{s,P}$是用户<code>s</code>对物品<code>p</code>的评分。</p>
<h4>2.4 ItemCF</h4>

<p>ItemCF是基于物品相似度进行推荐的协同过滤算法。通过计算共现矩阵中物品列向量的相似度得到物品之间的相似矩阵，再找到用户的历史正反馈物品的相似物品进行进一步排序和推荐。</p>
<ol>
<li>基于历史数据，构建以用户（假设用户总数为m）为行坐标，物品（物品总数为n）为列坐标的<code>m * n</code>维的共现矩阵。</li>
<li>计算共现矩阵两两列向量间的相似性（相似度的计算方式与用户相似度的计算方式相同），构建<code>n * n</code>维的物品相似度矩阵。</li>
<li>获得用户历史行为数据中的正反馈物品列表。</li>
<li>利用物品相似度矩阵，针对目标用户历史行为中的正反馈物品，找出相似的Top k个物品，组成相似物品集合。</li>
<li>对相似物品集合中的物品，利用相似度分值进行排序，生成最终的推荐列表。</li>
</ol>
<h4 id="2-5-CF的缺点"><a href="#2-5-CF的缺点" class="headerlink" title="2.5 CF的缺点"></a>2.5 CF的缺点</h4><ul>
<li>CF的天然缺陷：推荐结果的头部效应较明显，处理稀疏向量的能力弱。</li>
<li>CF仅利用用户和物品的交互信息，无法有效地引入用户年龄、性别、商品描述、商品分类、当前时间等一系列用户特征、物品特征和上下文特征。</li>
</ul>
<h2>三、矩阵分解</h2>

<p>矩阵分解在CF中“共现矩阵”的基础上，加入了<b>隐向量</b>的概念，加强了模型处理稀疏矩阵的能力。</p>
<img src="https://i.loli.net/2020/07/11/bFJ4WoyBGTvUDpg.jpg" alt="A9DA0BC6-B77A-485E-8A5D-DE44BE271712.png" style="zoom:50%;" />

<h4>3.1矩阵分解的求解过程</h4>

<p>主要方法有三种：</p>
<ul>
<li>特征值分解（Eigen Decomposition）：只能作用于方阵</li>
<li>奇异值分解（singular Value Decomposition, SVD）：<img src="https://i.loli.net/2020/07/11/Uzw2Id8ER1t3Prx.jpg" alt="6812192D-0640-4957-90E1-9A131EF5B6A9.png"></li>
<li>梯度下降（Gradient Descent）:<br>求解矩阵分解的目标函数：<br>$$min_{q^<em>,p^</em>}\Sigma_{(u,i)\in K}(r_{u,i}-q_i^Tp_u)^2+\lambda(||q_i||+||p_u||)^2$$</li>
</ul>
<p>在矩阵分解算法中，由于隐向量的存在，使人意的用户和物品之间都可以得到预测分值。而隐向量的生成过程其实是对共现矩阵进行全局拟合的过程，因此隐向量其实是利用全局信息生成的，有更强的泛化能力。</p>
<h4 id="3-2-MF优缺点"><a href="#3-2-MF优缺点" class="headerlink" title="3.2 MF优缺点"></a>3.2 MF优缺点</h4><ul>
<li><p>优点：</p>
<ol>
<li>泛化能力强</li>
<li>空间复杂度低：(n+m)·k</li>
<li>更好的扩展性和灵活性</li>
</ol>
</li>
<li><p>缺点：</p>
<ol>
<li>MF同样不方便加入用户、物品和上下文相关的特征</li>
<li>在缺乏用户历史行为时，无法进行有效的推荐</li>
</ol>
</li>
</ul>
<h2>四、逻辑回归</h2>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://daluzi.top/2020/06/27/%E7%AC%AC%E4%BA%8C%E7%AB%A0/" data-id="ckciuzzyw000z4bxegazd065x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/DL/" rel="tag">DL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/recommendation/" rel="tag">recommendation</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../28/Docker/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Docker
        
      </div>
    </a>
  
  
    <a href="../%E7%AC%AC%E4%B8%80%E7%AB%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">第一章</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/Heterogeneous-Networks/">Heterogeneous Networks</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/KG/">KG</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/leetcode/">leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/recommendation/">recommendation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/recommendation/HIN/">HIN</a></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/recommendation/explainable-recommendation/">explainable recommendation</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/%E3%80%8A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E3%80%8B/">《深度学习推荐系统》</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/DL/" rel="tag">DL</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/Deeplearning/" rel="tag">Deeplearning</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/GCN/" rel="tag">GCN</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/GNN/" rel="tag">GNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/GNN-GCN/" rel="tag">GNN/GCN</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/HIN/" rel="tag">HIN</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/Heterogeneous-Information-Networks/" rel="tag">Heterogeneous Information Networks</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/KG/" rel="tag">KG</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/Meta-graph/" rel="tag">Meta-graph</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/Muilimodal/" rel="tag">Muilimodal</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/RS/" rel="tag">RS</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/Recommendation/" rel="tag">Recommendation</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/explainability/" rel="tag">explainability</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/graph-learning/" rel="tag">graph-learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/heterogeneous/" rel="tag">heterogeneous</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/heterogeneous-GNN/" rel="tag">heterogeneous GNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/leetcode/" rel="tag">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/machine-learning/" rel="tag">machine learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/meta-path/" rel="tag">meta path</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/negative-sampling-based-method/" rel="tag">negative sampling-based method</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/recommendation/" rel="tag">recommendation</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/regression-tree/" rel="tag">regression tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/skip-gram/" rel="tag">skip-gram</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/survey/" rel="tag">survey</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../../../../tags/DL/" style="font-size: 15px;">DL</a> <a href="../../../../tags/Deeplearning/" style="font-size: 10px;">Deeplearning</a> <a href="../../../../tags/GCN/" style="font-size: 10px;">GCN</a> <a href="../../../../tags/GNN/" style="font-size: 10px;">GNN</a> <a href="../../../../tags/GNN-GCN/" style="font-size: 10px;">GNN/GCN</a> <a href="../../../../tags/HIN/" style="font-size: 10px;">HIN</a> <a href="../../../../tags/Heterogeneous-Information-Networks/" style="font-size: 10px;">Heterogeneous Information Networks</a> <a href="../../../../tags/KG/" style="font-size: 10px;">KG</a> <a href="../../../../tags/Meta-graph/" style="font-size: 10px;">Meta-graph</a> <a href="../../../../tags/Muilimodal/" style="font-size: 10px;">Muilimodal</a> <a href="../../../../tags/RS/" style="font-size: 10px;">RS</a> <a href="../../../../tags/Recommendation/" style="font-size: 10px;">Recommendation</a> <a href="../../../../tags/docker/" style="font-size: 10px;">docker</a> <a href="../../../../tags/explainability/" style="font-size: 10px;">explainability</a> <a href="../../../../tags/graph-learning/" style="font-size: 10px;">graph-learning</a> <a href="../../../../tags/heterogeneous/" style="font-size: 10px;">heterogeneous</a> <a href="../../../../tags/heterogeneous-GNN/" style="font-size: 10px;">heterogeneous GNN</a> <a href="../../../../tags/hexo/" style="font-size: 10px;">hexo</a> <a href="../../../../tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="../../../../tags/machine-learning/" style="font-size: 10px;">machine learning</a> <a href="../../../../tags/meta-path/" style="font-size: 10px;">meta path</a> <a href="../../../../tags/negative-sampling-based-method/" style="font-size: 10px;">negative sampling-based method</a> <a href="../../../../tags/recommendation/" style="font-size: 20px;">recommendation</a> <a href="../../../../tags/regression-tree/" style="font-size: 10px;">regression tree</a> <a href="../../../../tags/skip-gram/" style="font-size: 10px;">skip-gram</a> <a href="../../../../tags/survey/" style="font-size: 10px;">survey</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2019/11/">November 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../../../07/12/test/">test</a>
          </li>
        
          <li>
            <a href="../../28/Docker/">Docker</a>
          </li>
        
          <li>
            <a href="">第二章：推荐系统的进化之路</a>
          </li>
        
          <li>
            <a href="../%E7%AC%AC%E4%B8%80%E7%AB%A0/">第一章</a>
          </li>
        
          <li>
            <a href="../../22/KG-learning/">KG_learning</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 daluzi<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/script.js"></script>



  </div>
</body>
</html>